#!/bin/bash

# ================================================================
# QORA NFT Platform - –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
# ================================================================
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–∏ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞
# –ö–æ–ø–∏—Ä—É–π—Ç–µ –∏ –≤—ã–ø–æ–ª–Ω—è–π—Ç–µ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ

# ================================================================
# 1. –£–°–¢–ê–ù–û–í–ö–ê –ó–ê–í–ò–°–ò–ú–û–°–¢–ï–ô
# ================================================================

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å pnpm (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
npm install -g pnpm

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
pnpm install

# ================================================================
# 2. –ù–ê–°–¢–†–û–ô–ö–ê –ü–ï–†–ï–ú–ï–ù–ù–´–• –û–ö–†–£–ñ–ï–ù–ò–Ø
# ================================================================

# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —à–∞–±–ª–æ–Ω .env
cp .env.example .env.local

# –û—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–≤—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω)
nano .env.local
# –∏–ª–∏
code .env.local
# –∏–ª–∏
vim .env.local

# –í—Å—Ç–∞–≤—å—Ç–µ –≤–∞—à–∏ Supabase credentials:
# NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
# NEXT_PUBLIC_SUPABASE_ANON_KEY=your_anon_key_here

# ================================================================
# 3. –ó–ê–ü–£–°–ö –ü–†–û–ï–ö–¢–ê
# ================================================================

# –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (—Å hot reload)
pnpm dev

# –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
# http://localhost:3000

# –°–±–æ—Ä–∫–∞ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
pnpm build

# –ó–∞–ø—É—Å–∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω –≤–µ—Ä—Å–∏–∏
pnpm start

# ================================================================
# 4. –ü–†–û–í–ï–†–ö–ê –†–ê–ë–û–¢–´
# ================================================================

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ .env.local —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
cat .env.local

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pnpm list --depth=0

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é Node.js (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å 18+)
node --version

# ================================================================
# 5. TROUBLESHOOTING
# ================================================================

# –û—á–∏—Å—Ç–∏—Ç—å node_modules –∏ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
rm -rf node_modules
rm -rf .next
pnpm install

# –û—á–∏—Å—Ç–∏—Ç—å –∫–µ—à Next.js
rm -rf .next

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ dev —Å–µ—Ä–≤–µ—Ä–∞
pnpm dev 2>&1 | tee dev.log

# ================================================================
# 6. GIT –ö–û–ú–ê–ù–î–´ (–¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –≤–µ—Ä—Å–∏–π)
# ================================================================

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å git (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —Å–¥–µ–ª–∞–Ω–æ)
git init

# –î–æ–±–∞–≤–∏—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã
git add .

# –°–¥–µ–ª–∞—Ç—å –∫–æ–º–º–∏—Ç
git commit -m "Database implementation with unique nicknames"

# –î–æ–±–∞–≤–∏—Ç—å remote (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à URL)
# git remote add origin https://github.com/your-username/qora-nft.git

# –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ GitHub
# git push -u origin main

# ================================================================
# 7. –ü–û–õ–ï–ó–ù–´–ï –ö–û–ú–ê–ù–î–´ NPM/PNPM
# ================================================================

# –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pnpm update

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –ø–∞–∫–µ—Ç—ã
pnpm outdated

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø–∞–∫–µ—Ç
pnpm add package-name

# –£–¥–∞–ª–∏—Ç—å –ø–∞–∫–µ—Ç
pnpm remove package-name

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –ª–∏–Ω—Ç–µ—Ä
pnpm lint

# –ò—Å–ø—Ä–∞–≤–∏—Ç—å lint –æ—à–∏–±–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
pnpm lint --fix

# ================================================================
# 8. DOCKER (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
# ================================================================

# –°–æ–∑–¥–∞—Ç—å Docker –æ–±—Ä–∞–∑
# docker build -t qora-nft-platform .

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
# docker run -p 3000:3000 --env-file .env.local qora-nft-platform

# ================================================================
# 9. VERCEL DEPLOYMENT
# ================================================================

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Vercel CLI
npm install -g vercel

# –í–æ–π—Ç–∏ –≤ Vercel
vercel login

# –î–µ–ø–ª–æ–π –ø—Ä–æ–µ–∫—Ç–∞
vercel

# –î–µ–ø–ª–æ–π –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω
vercel --prod

# ================================================================
# 10. –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï API
# ================================================================

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å API –ø—Ä–æ–≤–µ—Ä–∫–∏ nickname
curl "http://localhost:3000/api/auth/check-nickname?nickname=test"

# –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:
# {"available":true,"message":"Nickname –¥–æ—Å—Ç—É–ø–µ–Ω"}

# ================================================================
# SUPABASE SQL –ú–ò–ì–†–ê–¶–ò–ò (–≤—ã–ø–æ–ª–Ω—è–π—Ç–µ –≤ Supabase SQL Editor)
# ================================================================

# 1. –û—Ç–∫—Ä–æ–π—Ç–µ Supabase Dashboard:
#    https://app.supabase.com/

# 2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç

# 3. –û—Ç–∫—Ä–æ–π—Ç–µ SQL Editor

# 4. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ —Å–ª–µ–¥—É—é—â–µ–º –ø–æ—Ä—è–¥–∫–µ:
#    - scripts/008_create_profiles_with_unique_nicknames.sql
#    - scripts/005_create_admin_tables.sql (–¥–ª—è –∞–¥–º–∏–Ω–∫–∏)
#    - scripts/006_admin_functions.sql (–¥–ª—è –∞–¥–º–∏–Ω–∫–∏)
#    - scripts/007_test_data.sql (—Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ)

# 5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã:
#    Table Editor > profiles (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤–∏–¥–Ω–∞)

# ================================================================
# SQL –ó–ê–ü–†–û–°–´ –î–õ–Ø –ü–†–û–í–ï–†–ö–ò (–≤ Supabase SQL Editor)
# ================================================================

# –í—Å–µ –ø—Ä–æ—Ñ–∏–ª–∏
# SELECT * FROM profiles;

# –ü—Ä–æ–≤–µ—Ä–∫–∞ nickname
# SELECT check_nickname_available('test');

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
# SELECT * FROM profile_stats;

# –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏
# SELECT routine_name FROM information_schema.routines WHERE routine_schema = 'public';

# ================================================================
# –ü–û–õ–ï–ó–ù–´–ï –ê–õ–ò–ê–°–´ (–¥–æ–±–∞–≤—å—Ç–µ –≤ ~/.zshrc –∏–ª–∏ ~/.bashrc)
# ================================================================

# alias qora-dev="cd /path/to/qora-nft && pnpm dev"
# alias qora-build="cd /path/to/qora-nft && pnpm build"
# alias qora-log="cd /path/to/qora-nft && tail -f dev.log"

# ================================================================
# –ü–ï–†–ï–ú–ï–ù–ù–´–ï –û–ö–†–£–ñ–ï–ù–ò–Ø –î–õ–Ø –†–ê–ó–ù–´–• –û–ö–†–£–ñ–ï–ù–ò–ô
# ================================================================

# Development (.env.local)
# NEXT_PUBLIC_SUPABASE_URL=https://dev-project.supabase.co
# NEXT_PUBLIC_SUPABASE_ANON_KEY=dev_key

# Production (.env.production)
# NEXT_PUBLIC_SUPABASE_URL=https://prod-project.supabase.co
# NEXT_PUBLIC_SUPABASE_ANON_KEY=prod_key

# ================================================================
# –ú–û–ù–ò–¢–û–†–ò–ù–ì –ò –õ–û–ì–ò
# ================================================================

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
# pnpm dev | tee -a dev.log

# Grep –ø–æ –æ—à–∏–±–∫–∞–º
# cat dev.log | grep -i error

# –°—É–º–º–∞—Ä–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
# wc -l dev.log

# ================================================================
# –ë–≠–ö–ê–ü –ë–ê–ó–´ –î–ê–ù–ù–´–• (—á–µ—Ä–µ–∑ Supabase CLI)
# ================================================================

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Supabase CLI
# npm install -g supabase

# –í–æ–π—Ç–∏
# supabase login

# –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø
# supabase db dump > backup_$(date +%Y%m%d_%H%M%S).sql

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –±—ç–∫–∞–ø–∞
# supabase db push < backup.sql

# ================================================================
# –ö–û–ù–ï–¶ –§–ê–ô–õ–ê
# ================================================================

echo "‚úÖ –í—Å–µ –∫–æ–º–∞–Ω–¥—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã!"
echo "üìö –°–º. –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é:"
echo "   - SUPABASE_SETUP.md"
echo "   - QUICK_DATABASE_SETUP.md"
echo "   - README.md"
