# üéØ –ß–µ–∫–ª–∏—Å—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ Admin Panel

## ‚úÖ –ü—Ä–µ—Ä–µ–∫–≤–∏–∑–∏—Ç—ã

- [ ] Node.js 18+ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [ ] pnpm —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (`npm i -g pnpm`)
- [ ] –ü—Ä–æ–µ–∫—Ç Supabase —Å–æ–∑–¥–∞–Ω
- [ ] –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (5 –º–∏–Ω—É—Ç)

### 1. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏
–í Supabase SQL Editor –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –ø–æ –ø–æ—Ä—è–¥–∫—É:

- [ ] `scripts/005_create_admin_tables.sql`
- [ ] `scripts/006_admin_functions.sql`

### 2. –ù–∞–∑–Ω–∞—á—å—Ç–µ —Å–µ–±–µ —Ä–æ–ª—å

```sql
-- –ü–æ–ª—É—á–∏—Ç–µ —Å–≤–æ–π UUID
SELECT id, email FROM auth.users WHERE email = '–≤–∞—à@email.com';

-- –ù–∞–∑–Ω–∞—á—å—Ç–µ —Ä–æ–ª—å Owner
INSERT INTO admin_roles (user_id, role) 
VALUES ('–≤–∞—à-uuid', 'owner');
```

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É

```sql
-- –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å 4 –∑–∞–ø–∏—Å–∏
SELECT * FROM settings;

-- –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤–∞—à–∞ —Ä–æ–ª—å
SELECT * FROM admin_roles;
```

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞ (2 –º–∏–Ω—É—Ç—ã)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pnpm install

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ dev —Å–µ—Ä–≤–µ—Ä
pnpm dev
```

–û—Ç–∫—Ä–æ–π—Ç–µ: http://localhost:3000/admin-panel

## üß™ –¢–µ—Å—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ (10 –º–∏–Ω—É—Ç)

### –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

- [ ] –°–æ–∑–¥–∞–π—Ç–µ –∫–æ–ª–ª–µ–∫—Ü–∏—é "Test Collection"
- [ ] –°–æ–∑–¥–∞–π—Ç–µ –∫–∞—Ä—Ç–æ—á–∫—É "Test Card" (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç—Å—è 3 –æ—Å–∫–æ–ª–∫–∞)
- [ ] –î–æ–±–∞–≤—å—Ç–µ URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è –æ—Å–∫–æ–ª–∫–æ–≤
- [ ] –î–æ–±–∞–≤—å—Ç–µ 3 —Ç–æ—á–∫–∏ —Å–ø–∞–≤–Ω–∞ (—Ä–∞–∑–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã)
- [ ] –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞—à–±–æ—Ä–¥ (–¥–æ–ª–∂–Ω–∞ –æ–±–Ω–æ–≤–∏—Ç—å—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞)

### –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ API

```bash
# –ü–æ–ª—É—á–∏—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏–∏
curl http://localhost:3000/api/admin/collections

# –ü–æ–ª—É—á–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∏
curl http://localhost:3000/api/admin/cards

# –ü–æ–ª—É—á–∏—Ç—å —Ç–æ—á–∫–∏ —Å–ø–∞–≤–Ω–∞
curl http://localhost:3000/api/admin/spawn-points
```

## üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ UI (5 –º–∏–Ω—É—Ç)

–û—Ç–∫—Ä–æ–π—Ç–µ –∫–∞–∂–¥—É—é –≤–∫–ª–∞–¥–∫—É –∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç:

- [ ] Dashboard - –≤–∏–¥–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- [ ] Collections - –µ—Å—Ç—å —Ñ–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è
- [ ] Cards - –µ—Å—Ç—å —Ñ–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è
- [ ] Shards - –º–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- [ ] Spawn Points - –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ç–æ—á–∫—É
- [ ] Drops - –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –¥—Ä–æ–ø
- [ ] Marketplace - –≤–∏–¥–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- [ ] Users - —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–∏—Å–∫
- [ ] Web3 - –º–æ–∂–Ω–æ –≤–≤–µ—Å—Ç–∏ –∫–æ–Ω—Ñ–∏–≥
- [ ] Settings - –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- [ ] Audit Log - –≤–∏–¥–Ω—ã –ª–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π

## üîí –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –¢–µ—Å—Ç –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ: http://localhost:3000/admin-panel
   - [ ] –î–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –ª–æ–≥–∏–Ω

2. –ó–∞–ª–æ–≥–∏–Ω—å—Ç–µ—Å—å –ù–ï –∞–¥–º–∏–Ω–æ–º
   - [ ] –î–æ–ª–∂–Ω–æ –±—ã—Ç—å "Unauthorized"

3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—ã–∑–≤–∞—Ç—å API –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:
   ```bash
   curl http://localhost:3000/api/admin/collections
   # –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å {"error": "Unauthorized"}
   ```

### –¢–µ—Å—Ç RLS

```sql
-- –û—Ç –∏–º–µ–Ω–∏ –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–Ω–µ –∞–¥–º–∏–Ω–∞)
-- –ù–µ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å:
INSERT INTO collections (name) VALUES ('Hack');
UPDATE spawn_points SET active = false WHERE id = 'any';
DELETE FROM cards WHERE id = 'any';
```

## üé® –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –ò–∑–º–µ–Ω–∏—Ç—å –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```sql
UPDATE settings SET value = '10' WHERE key = 'radius_m';
UPDATE settings SET value = '5' WHERE key = 'hold_seconds';
UPDATE settings SET value = '7.5' WHERE key = 'platform_fee_pct';
```

### –î–æ–±–∞–≤–∏—Ç—å –≤—Ç–æ—Ä–æ–≥–æ –∞–¥–º–∏–Ω–∞ (Manager)

```sql
INSERT INTO admin_roles (user_id, role) 
VALUES ('–¥—Ä—É–≥–æ–π-uuid', 'manager');
```

## üìù –õ–æ–≥–∏ –∏ –¥–µ–±–∞–≥

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ Supabase

1. –û—Ç–∫—Ä–æ–π—Ç–µ Supabase Dashboard
2. Logs ‚Üí Database Logs
3. –§–∏–ª—å—Ç—Ä –ø–æ `audit_log`

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
# –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –≥–¥–µ –∑–∞–ø—É—â–µ–Ω pnpm dev
# –í—Å–µ API –∑–∞–ø—Ä–æ—Å—ã –±—É–¥—É—Ç –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å—Å—è
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—à–∏–±–æ–∫

```sql
-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ—à–∏–±–∫–∏ –≤ –ª–æ–≥–∞—Ö
SELECT * FROM audit_log 
WHERE action LIKE '%error%' 
ORDER BY ts DESC 
LIMIT 10;
```

## üêõ Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: "Unauthorized"
**–†–µ—à–µ–Ω–∏–µ:**
```sql
-- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–æ–ª—å
SELECT * FROM admin_roles WHERE user_id = '–≤–∞—à-uuid';
-- –ï—Å–ª–∏ –Ω–µ—Ç, –¥–æ–±–∞–≤—å—Ç–µ
INSERT INTO admin_roles (user_id, role) VALUES ('–≤–∞—à-uuid', 'owner');
```

### –ü—Ä–æ–±–ª–µ–º–∞: –¢–∞–±–ª–∏—Ü—ã –Ω–µ —Å–æ–∑–¥–∞–Ω—ã
**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≤—ã–ø–æ–ª–Ω–∏–ª–∏ –æ–±–µ –º–∏–≥—Ä–∞—Ü–∏–∏ (005 –∏ 006)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –≤ Supabase

### –ü—Ä–æ–±–ª–µ–º–∞: API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 404
**–†–µ—à–µ–Ω–∏–µ:**
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ dev —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç—å: `/api/admin/...`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ:**
```sql
-- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∞–±–ª–∏—Ü—É settings
SELECT * FROM settings;
-- –ï—Å–ª–∏ –ø—É—Å—Ç–∞, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–Ω–æ–≤–æ scripts/005...sql
```

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω–¥–µ–∫—Å—ã

```sql
-- –î–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω—ã –∏–Ω–¥–µ–∫—Å—ã
SELECT * FROM pg_indexes WHERE tablename IN (
  'spawn_points', 'user_shards', 'listings', 'audit_log'
);
```

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (–µ—Å–ª–∏ –º–µ–¥–ª–µ–Ω–Ω–æ)

```sql
-- –ê–Ω–∞–ª–∏–∑ —Ç–∞–±–ª–∏—Ü
ANALYZE collections;
ANALYZE cards;
ANALYZE spawn_points;
ANALYZE listings;
```

## ‚úÖ –§–∏–Ω–∞–ª—å–Ω—ã–π —á–µ–∫–ª–∏—Å—Ç

–ü–æ—Å–ª–µ –≤—Å–µ—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:

- [ ] ‚úÖ –ë–î –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
- [ ] ‚úÖ –†–æ–ª—å Owner –Ω–∞–∑–Ω–∞—á–µ–Ω–∞
- [ ] ‚úÖ –ü—Ä–æ–µ–∫—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] ‚úÖ –í—Å–µ 11 –≤–∫–ª–∞–¥–æ–∫ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è
- [ ] ‚úÖ API endpoints —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] ‚úÖ –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é
- [ ] ‚úÖ –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É
- [ ] ‚úÖ –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ç–æ—á–∫—É —Å–ø–∞–≤–Ω–∞
- [ ] ‚úÖ –õ–æ–≥–∏ –ø–∏—à—É—Ç—Å—è –≤ audit_log
- [ ] ‚úÖ –ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–∞—é—Ç 401

## üéâ –ì–æ—Ç–æ–≤–æ!

–ï—Å–ª–∏ –≤—Å–µ —á–µ–∫–±–æ–∫—Å—ã –æ—Ç–º–µ—á–µ–Ω—ã - –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ!

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
1. –°–æ–∑–¥–∞–π—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
3. –†–∞–∑–º–µ—Å—Ç–∏—Ç–µ —Ç–æ—á–∫–∏ –Ω–∞ –∫–∞—Ä—Ç–µ
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Web3 –∫–æ–Ω—Ç—Ä–∞–∫—Ç
5. –ü—Ä–∏–≥–ª–∞—Å–∏—Ç–µ –¥—Ä—É–≥–∏—Ö –∞–¥–º–∏–Ω–æ–≤

**–í—Ä–µ–º—è –Ω–∞ –ø–æ–ª–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É: ~25 –º–∏–Ω—É—Ç**

---

**Need help?** –ß–∏—Ç–∞–π—Ç–µ [ADMIN_PANEL.md](ADMIN_PANEL.md) –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π
