# ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ - –ü–æ–ª–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

–í—Å–µ –∑–∞–¥–∞—á–∏ —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –∏ –∑–∞–¥–µ–ø–ª–æ–µ–Ω—ã –Ω–∞ Railway (qora.store).

## 1. üé® –ù–∞—Å—Ç–æ—è—â–∏–π TON –ú–∏–Ω—Ç

**–§–∞–π–ª—ã:**
- `components/card-details-modal.tsx` - –†–µ–∞–ª—å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è TON Connect
- `app/api/mint/ton/route.ts` - API –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```typescript
// –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
POST /api/mint/ton
{
  userId, cardId, walletAddress
} 
‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç { transaction } –¥–ª—è TonConnect

// –û—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ TonConnect UI
await tonConnectUI.sendTransaction(transaction)

// –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –º–∏–Ω—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
PUT /api/mint/ton
{
  cardId, txHash
}
‚Üí —É–¥–∞–ª—è–µ—Ç –∫–∞—Ä—Ç—É –∏–∑ –±–∞–∑—ã, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Å—ã–ª–∫—É –Ω–∞ tonscan
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 
- –†–µ–∞–ª—å–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ TON blockchain
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã –ø–æ—Å–ª–µ –º–∏–Ω—Ç–∞
- –°—Å—ã–ª–∫–∞ –Ω–∞ explorer –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

---

## 2. üîê –ê–≤—Ç–æ–ª–æ–≥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–§–∞–π–ª—ã:**
- `components/auto-login.tsx` - –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∞–≤—Ç–æ–ª–æ–≥–∏–Ω–∞
- `app/layout.tsx` - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –≥–ª–∞–≤–Ω—ã–π layout
- `app/login/page.tsx` - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ userId –ø—Ä–∏ –ª–æ–≥–∏–Ω–µ
- `app/api/auth/verify-session/route.ts` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ —Å–µ—Å—Å–∏–∏

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```typescript
// –ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –ª–æ–≥–∏–Ω–µ
localStorage.setItem('qora_autologin_userId', userId)

// –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
<AutoLogin /> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç localStorage
‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç POST /api/auth/verify-session
‚Üí –µ—Å–ª–∏ —Å–µ—Å—Å–∏—è –≤–∞–ª–∏–¥–Ω–∞, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Å—Ç–∞—ë—Ç—Å—è –∑–∞–ª–æ–≥–∏–Ω–µ–Ω–Ω—ã–º
‚Üí –µ—Å–ª–∏ –Ω–µ—Ç, –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ /login
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Å—Ç–∞—ë—Ç—Å—è –∑–∞–ª–æ–≥–∏–Ω–µ–Ω–Ω—ã–º –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ —Å–µ—Å—Å–∏–∏
- –ó–∞—â–∏—Ç–∞ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü

---

## 3. üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã –ø–æ—Å–ª–µ –º–∏–Ω—Ç–∞

**–§–∞–π–ª—ã:**
- `app/api/mint/ton/route.ts` (PUT) - –í—ã–∑–æ–≤ `deleteCardAfterMint`
- `app/inventory/page.tsx` - –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
- `components/card-details-modal.tsx` - Callback –ø–æ—Å–ª–µ –º–∏–Ω—Ç–∞

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```typescript
// –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –º–∏–Ω—Ç–∞
PUT /api/mint/ton ‚Üí deleteCardAfterMint(cardId)
‚Üí —É–¥–∞–ª—è–µ—Ç –∏–∑ userCards
‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç onMint() callback
‚Üí frontend –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
‚Üí –∫–∞—Ä—Ç–∞ –∏—Å—á–µ–∑–∞–µ—Ç –∏–∑ UI
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ö–∞—Ä—Ç–∞ —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ –±–∞–∑—ã –ø–æ—Å–ª–µ –º–∏–Ω—Ç–∞
- UI –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –º–∏–Ω—Ç

---

## 4. üìä –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Å–∫–æ–ª–∫–æ–≤

**–§–∞–π–ª—ã:**
- `app/api/inventory/route.ts` - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –ø–æ–¥—Å—á—ë—Ç –ø–æ —Ä–µ–¥–∫–æ—Å—Ç–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** 
`shardsByRarity` –≤—Å–µ–≥–¥–∞ –±—ã–ª `{common: 0, rare: 0, ...}` –ø–æ—Ç–æ–º—É —á—Ç–æ –Ω–µ —Å—á–∏—Ç–∞–ª—Å—è.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```typescript
// –î–æ–±–∞–≤–ª–µ–Ω –ø–æ–¥—Å—á—ë—Ç –æ—Å–∫–æ–ª–∫–æ–≤
shards.forEach(us => {
  const rarity = us.shard.card.rarity.toLowerCase()
  if (rarity in shardsByRarity) {
    shardsByRarity[rarity]++
  }
})
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Å–∫–æ–ª–∫–æ–≤ –ø–æ —Ä–µ–¥–∫–æ—Å—Ç–∏
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ

---

## 5. üíæ Railway –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Ä–∞–Ω–µ–µ

**–¢–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
- PostgreSQL –Ω–∞ Railway
- Prisma ORM –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
- –í—Å–µ –¥–∞–Ω–Ω—ã–µ –≤ –±–∞–∑–µ: Users, Shards, UserShards, UserCards, SpawnPoints

**–§–∞–π–ª—ã:**
- `lib/db.ts` - Prisma Client
- `lib/db-storage.ts` - –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Prisma
- `prisma/schema.prisma` - –°—Ö–µ–º–∞ –±–∞–∑—ã

---

## üöÄ Deployment

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–ø—É—à–µ–Ω—ã –Ω–∞ GitHub –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–ø–ª–æ—è—Ç—Å—è –Ω–∞ Railway:

```bash
git commit -m "feat: –í—Å–µ –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã"
git push origin main
```

**Commit:** `9e93e5f`

**Production URL:** https://qora.store

---

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

‚úÖ **1 –∫–∞—Ä—Ç–æ—á–∫–∞** "Qora Card"  
‚úÖ **3 –æ—Å–∫–æ–ª–∫–∞** (A, B, C) —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏  
‚úÖ **–ù–∞—Å—Ç–æ—è—â–∏–π TON –º–∏–Ω—Ç** —á–µ—Ä–µ–∑ TonConnect  
‚úÖ **–ê–≤—Ç–æ–ª–æ–≥–∏–Ω** –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã  
‚úÖ **–£–¥–∞–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã** –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –º–∏–Ω—Ç–∞  
‚úÖ **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Å–∫–æ–ª–∫–æ–≤** —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ  
‚úÖ **Railway –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å** —á–µ—Ä–µ–∑ PostgreSQL  

–ü–æ–ª–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üéâ
